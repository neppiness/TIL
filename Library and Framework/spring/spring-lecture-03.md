[TIL on April 21st, 2023](../../TIL/2023/04/04-21-2023.md)
# **스프링 MVC 1편 - 백엔드 웹 개발 핵심 기술**

### 섹션 1. 웹 애플리케이션 이해

#### 웹 서버, 웹 애플리케이션 서버(WAS)
* 웹 어플리케이션 서버는 웹 서버와 다르게 프로그램 코드를 실행해서 어플리케이션 로직을 수행할 수 있음.
* WAS는 어플리케이션 코드를 실행화는 데 특화됨.

* 사실 WAS만 가지고 웹 시스템을 구성할 수 있지만, 그렇게 하면 WAS에 과부하가 많이 걸려 문제가 발생할 수 있음.
  - 그래서 웹 서버를 두고, 정적 리소스를 전달하는 작업 등은 웹 서버가 수행. 어플리케이션 로직이 필요할 경우 WAS에 전달.
  - 이렇게 두는 경우, WAS가 다운됐을 때, 웹 서버가 WAS의 상황을 알려줄 수도 있음.

#### 서블릿
* 실질적 비즈니스 로직 외 모든 작업을 서블릿이 해준다.

```java
@WebServlet(name = "helloServlet", urlPatterns = "/hello")
public class HelloServlet extends HttpServlet {

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) {
        // 어플리케이션 로직
    }
}
```

* 요청 정보와 응답 정보를 서블릿을 통해 간단히 사용할 수 있다.

* 서블릿 컨테이너
  - 톰캣처럼 서블릿을 지원하는 WAS를 서블릿 컨테이너라고 함
  - 서블릿 객체는 싱글톤으로 관리
  - 같은 서버에 요청하면 같은 서블릿 컨테이너에 요청을 하는 것
  - 공유 변수를 사용할 때 조심해야 한다.
* 동시 요청을 위한 멀티 쓰레드 처리 지원
  - 개발자가 멀티 쓰레드를 크게 신경 쓰지 않아도, WAS가 처리해준다.

#### 동시 요청 - 멀티 쓰레드
* 쓰레드
  - 어플리케이션 코드를 하나 하나를 내부에서 순차적으로 실행함.
  - 프로세스와 비교. 프로세스는 프로그램을 실행하는 것. 쓰레드는 프로그램 내에서 작업을 분배하는 것.
  - 자바 메인 메서드를 처음 실행하면 main이라는 이름의 쓰레드가 실행됨.

* 요청 마다 이를 처리하는 쓰레드를 추가로 생성해주면 적절한 처리가 가능함.
  - 장점: 여러 요청을 동시에 처리할 수 있음
  - 단점: 쓰레드 생성은 비용이 크다. 코어가 쓰레드 간 전환을 수행할 때 발생하는 비용인 컨텍스트 스위칭 비용이 발생한다. 쓰레드 생성 제한이 없어 리소스 한계를 넘으면 다운된다.

* 쓰레드 풀
  - 쓰레드 풀에 운용 가능한 쓰레드를 생성해놓고, 요청이 들어오면 쓰레드를 할당해주는 방식.
  - 이 한도를 넘는 요청이 들어오면 쓰레드를 대기시키거나 거절해버린다(수강신청이나 할인 이벤트 트래픽 폭주가 떠오름).

* WAS의 멀티 쓰레드 지원: 개발자는 이 멀티 쓰레드 처리를 고민하지 않아도 된다. 그러나, 멀티 쓰레드 환경이니 싱글톤 객체 사용 시 주의해야 한다는 것이 골자.

#### HTML, HTTP API, CSR, SSR
* 정적 컨텐츠, HTML 페이지, HTTP API: 웹 서버, WAS가 주고 받는 정보들.
  - HTTP API: 브라우저-서버, 앱-서버, 서버-서버 간 데이터 교환

* SSR-서버 사이드 렌더링, CSR-클라이언트 사이드 렌더링
  - SSR: HTML 최종 결과를 서버에서 만들어서 웹 브라우저에 전달. 주로 정적인 화면에 사용함.
  - CSR: 주로 동적인 화면에 사용. 웹 환경을 마치 앱처럼 필요한 부분부분 변경할 수 있음.

* JSP(죽음), 타임리프를 활용한 서버 사이드 렌더링 기술.
  - 백엔드 개발자는 서버 사이드 렌더링 기술 학습이 필수적이다.

#### 자바 백엔드 웹 기술 역사
* 서블릿 > JSP > 서블릿, JSP 조합 MVC 패턴 사용 > MVC 프레임워크 춘추 전국 시대
  - 웹은 개발할 때 고민할 게 이미 많은데, 그 외적인 요소들은 편리하게 처리할 수 있게 프레임워크를 준비했던 모양.

* 개발자들이 불편하게 느꼈던 부분을 굉장히 편리하게 만들어준 것.
  - 서버를 '배포'하는 것도 편하게 만들어줬음.

* 스프링 웹 기술의 분화
  - Web Servlet - Spring MVC
  - Web Reactive - Spring WebFlux: 최신 기술. CPU와 쓰레드 수를 맞춰서 컨텍스트 스위칭 비용을 최소화함.

* 뷰 템플릿
  - JSP: 속도 느림, 기능 부족.
  - 프리마커, 벨로시티: 속도 문제 해결, 다양한 기능.
  - *타임리프*: 내츄럴 템플릿(HTML 모양이 유지됨). 스프링 MVC와 강력한 기능 통합.